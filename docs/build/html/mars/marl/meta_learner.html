

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>MARL &mdash; MARS 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Equilibrium Solvers" href="../equilibrium_solver/solvers.html" />
    <link rel="prev" title="PPO" href="../rl/ppo.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MARS
          

          
            
            <img src="../../_static/mars_label.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/intro.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Install MARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/install.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/quick_start.html">A Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/general.html">General Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/sarl.html">Single-Agent RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/marl.html">Multi-Agent RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/notes.html">Some Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MARS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rl/agent.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rl/dqn.html">DQN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rl/ppo.html">PPO</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MARL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#meta-learner-class">Meta-Learner Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mars.marl.selfplay">Self-Play Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#double-oracle-class">Double Oracle Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../equilibrium_solver/solvers.html">Equilibrium Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/data_struct.html">Data Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/func.html">Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/env.html">Environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Primal Experiments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../experiments/single_agent.html">Single-Agent Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../experiments/exploit.html">Exploitability Test</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MARS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MARL</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/mars/marl/meta_learner.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="marl">
<h1>MARL<a class="headerlink" href="#marl" title="Permalink to this headline">¶</a></h1>
<div class="section" id="meta-learner-class">
<h2>Meta-Learner Class<a class="headerlink" href="#meta-learner-class" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mars.marl.selfplay">
<span id="self-play-class"></span><h2>Self-Play Class<a class="headerlink" href="#module-mars.marl.selfplay" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mars.marl.selfplay.FictitiousSelfPlayMetaLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">mars.marl.selfplay.</span></span><span class="sig-name descname"><span class="pre">FictitiousSelfPlayMetaLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#FictitiousSelfPlayMetaLearner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.FictitiousSelfPlayMetaLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner" title="mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner</span></code></a></p>
<p>Meta learn is the  for MARL meta strategy, 
which assigns the policy update schedule on a level higher
than policy update itself in standard RL.</p>
<p>Fictitious selfplay is the learning scheme that the agent always learn
against the average of the historical best response policy. If the policies can 
not be explicitly averaged, then a league of historical policies needs to be maintained.
The policy is stored and saved into the league when its average recent performance 
since the last checkpoint achieves a certain threshold score over its opponent 
or for a long enough training period.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mars.marl.selfplay.FictitiousSelfPlayMetaLearner.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">Args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#FictitiousSelfPlayMetaLearner.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.FictitiousSelfPlayMetaLearner.step" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta learner step (usually at the end of each episode), update models if available.</p>
<dl class="simple">
<dt>params: </dt><dd><dl class="field-list simple">
<dt class="field-odd">min_update_interval</dt>
<dd class="field-odd"><p>mininal opponent update interval in unit of episodes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">mars.marl.selfplay.</span></span><span class="sig-name descname"><span class="pre">FictitiousSelfPlaySymMetaLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#FictitiousSelfPlaySymMetaLearner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.marl.meta_learner.MetaLearner</span></code></p>
<p>Meta learn is the  for MARL meta strategy, 
which assigns the policy update schedule on a level higher
than policy update itself in standard RL.</p>
<p>Fictitious selfplay is the learning scheme that the agent always learn
against the average of the historical best response policy. If the policies can 
not be explicitly averaged, then a league of historical policies needs to be maintained.
The policy is stored and saved into the league when its average recent performance 
since the last checkpoint achieves a certain threshold score over its opponent 
or for a long enough training period.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">Args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#FictitiousSelfPlaySymMetaLearner.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.FictitiousSelfPlaySymMetaLearner.step" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta learner step (usually at the end of each episode), update models if available.</p>
<dl class="simple">
<dt>params: </dt><dd><dl class="field-list simple">
<dt class="field-odd">min_update_interval</dt>
<dd class="field-odd"><p>mininal opponent update interval in unit of episodes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mars.marl.selfplay.SelfPlayMetaLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">mars.marl.selfplay.</span></span><span class="sig-name descname"><span class="pre">SelfPlayMetaLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#SelfPlayMetaLearner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.SelfPlayMetaLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mars.marl.selfplay.SelfPlaySymMetaLearner" title="mars.marl.selfplay.SelfPlaySymMetaLearner"><code class="xref py py-class docutils literal notranslate"><span class="pre">mars.marl.selfplay.SelfPlaySymMetaLearner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mars.marl.selfplay.SelfPlayMetaLearner.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">Args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#SelfPlayMetaLearner.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.SelfPlayMetaLearner.step" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta learner step (usually at the end of each episode), update models if available.</p>
<dl class="simple">
<dt>params: </dt><dd><dl class="field-list simple">
<dt class="field-odd">min_update_interval</dt>
<dd class="field-odd"><p>mininal opponent update interval in unit of episodes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mars.marl.selfplay.SelfPlaySymMetaLearner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">mars.marl.selfplay.</span></span><span class="sig-name descname"><span class="pre">SelfPlaySymMetaLearner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#SelfPlaySymMetaLearner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.SelfPlaySymMetaLearner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.marl.meta_learner.MetaLearner</span></code></p>
<p>Meta learn is the  for MARL meta strategy, 
which assigns the policy update schedule on a level higher
than policy update itself in standard RL.</p>
<p>Selfplay is the learning scheme following iterative best response,
where the agent always learn against the latest version of its historical policies.
The policy is stored and updated to its opponent when its average recent performance
achieves a certain threshold score over its opponent or for a long enough training period.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mars.marl.selfplay.SelfPlaySymMetaLearner.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">Args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mars/marl/selfplay.html#SelfPlaySymMetaLearner.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mars.marl.selfplay.SelfPlaySymMetaLearner.step" title="Permalink to this definition">¶</a></dt>
<dd><p>A meta learner step (usually at the end of each episode), update models if available.</p>
<dl class="simple">
<dt>params: </dt><dd><dl class="field-list simple">
<dt class="field-odd">min_update_interval</dt>
<dd class="field-odd"><p>mininal opponent update interval in unit of episodes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="double-oracle-class">
<h2>Double Oracle Class<a class="headerlink" href="#double-oracle-class" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../equilibrium_solver/solvers.html" class="btn btn-neutral float-right" title="Equilibrium Solvers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../rl/ppo.html" class="btn btn-neutral float-left" title="PPO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Zihan Ding.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>