echo "Running DATE:" $(date +"%Y-%m-%d %H:%M")

DATE=`date '+%Y%m%d_%H%M'`
echo "Save as: " $DATE

# declare -a envs=('pettingzoo_boxing_v1' 'pettingzoo_pong_v2' 'pettingzoo_surround_v1' 'pettingzoo_tennis_v2')
# declare -a envs=('pettingzoo_boxing_v1' 'slimevolley_SlimeVolley-v0')
# declare -a envs=('slimevolley_SlimeVolley-v0' 'pettingzoo_boxing_v1' 'pettingzoo_tennis_v2' 'pettingzoo_pong_v2' 'pettingzoo_ice_hockey_v1')
declare -a envs=('pettingzoo_double_dunk_v2' 'pettingzoo_space_war_v1' 'pettingzoo_surround_v1' 'pettingzoo_basketball_pong_v2')


declare -a methods=('selfplay2' 'fictitious_selfplay2' 'nxdo2' 'nfsp' 'nash_ppo' )
# declare -a methods=('nash_dqn' 'nash_dqn_exploiter')
# declare -a methods=('nash_dqn_factorized' 'nash_dqn' 'nash_dqn_exploiter')

LoadFrom='20220425_1813'
declare -a ToExploit=('first' 'second')  # 'first' or 'second'
# mkdir -p log/exploit_${ToExploit}_${LoadFrom}_50000
mkdir -p log/exploit_first_${LoadFrom}
mkdir -p log/exploit_second_${LoadFrom}

for k in ${!ToExploit[@]}; do
    for i in ${!envs[@]}; do
        for j in ${!methods[@]}; do
            echo CUDA_VISIBLE_DEVICES=$((j + 0)) python general_exploit.py --env ${envs[$i]} --method ${methods[$j]} --load_id $LoadFrom --save_id $DATE --to_exploit ${ToExploit[$k]} output log to: log/exploit_${ToExploit[$k]}_${LoadFrom}/${envs[$i]}_${methods[$j]}.log &
            CUDA_VISIBLE_DEVICES=$((j + 0)) nohup python general_exploit.py --env ${envs[$i]} --method ${methods[$j]} --load_id $LoadFrom --save_id $DATE --to_exploit ${ToExploit[$k]} >> log/exploit_${ToExploit[$k]}_${LoadFrom}/${envs[$i]}_${methods[$j]}.log &
            # CUDA_VISIBLE_DEVICES=$((j + 0)) nohup python general_exploit.py --env ${envs[$i]} --method ${methods[$j]} --load_id $LoadFrom --save_id $DATE --to_exploit $ToExploit >> log/exploit_${ToExploit}_${LoadFrom}_50000/${envs[$i]}_${methods[$j]}.log &

        done
    done
done

