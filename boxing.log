/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/ecos/ecos.py:26: UserWarning: Converting G to a CSC matrix; may take a while.
  warn("Converting G to a CSC matrix; may take a while.")
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/ecos/ecos.py:29: UserWarning: Converting A to a CSC matrix; may take a while.
  warn("Converting A to a CSC matrix; may take a while.")
wandb: Currently logged in as: quantumiracle. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.13.7 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.2
wandb: Run data is saved locally in /data/zihan/research/MARS/wandb/run-20221219_045044-2fpvngfm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run azure-serenity-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/quantumiracle/boxing-v5
wandb: üöÄ View run at https://wandb.ai/quantumiracle/boxing-v5/runs/2fpvngfm
A.L.E: Arcade Learning Environment (version 0.7.4+069f8bd)
[Powered by Stella]
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/utils/seeding.py:160: DeprecationWarning: [33mWARN: Function `hash_seed(seed, max_bytes)` is marked as deprecated and will be removed in the future. [0m
  "Function `hash_seed(seed, max_bytes)` is marked as deprecated and will be removed in the future. "
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/utils/seeding.py:204: DeprecationWarning: [33mWARN: Function `_bigint_from_bytes(bytes)` is marked as deprecated and will be removed in the future. [0m
  "Function `_bigint_from_bytes(bytes)` is marked as deprecated and will be removed in the future. "
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/core.py:318: DeprecationWarning: [33mWARN: Initializing wrapper in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future.[0m
  "Initializing wrapper in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future."
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/wrappers/step_api_compatibility.py:40: DeprecationWarning: [33mWARN: Initializing environment in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future.[0m
  "Initializing environment in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future."
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/wrappers/record_video.py:79: UserWarning: [33mWARN: Overwriting existing videos at /data/zihan/research/MARS/data/videos/gym_ALE/Boxing-v5_DQN_0 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  f"Overwriting existing videos at {self.video_folder} folder "
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/wandb/sdk/lib/import_hooks.py:246: DeprecationWarning: Deprecated since Python 3.4. Use importlib.util.find_spec() instead.
  loader = importlib.find_loader(fullname, path)
/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/utils/passive_env_checker.py:196: UserWarning: [33mWARN: Future gym versions will require that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information.[0m
  "Future gym versions will require that `Env.reset` can be passed `options` to allow the environment initialisation to be passed additional information."
ALE/Boxing-v5 gym
record video: interval 1000, length 300
Load ALE/Boxing-v5 environment in type gym.
Env observation space: Box(0, 1, (3, 210, 160), uint8) action space: Discrete(18)
random seed: 519
<RecordVideo<mars.env.wrappers.mars_wrappers.Gym2AgentWrapper object at 0x7f74fb733e10>>
Agents No. [1] (index starting from 0) are not learnable.
Arguments:  {'env_name': 'ALE/Boxing-v5', 'env_type': 'gym', 'num_envs': 1, 'ram': False, 'seed': 'random', 'adversarial': False, 'record_video': True, 'algorithm': 'DQN', 'algorithm_spec': {'episodic_update': False, 'dueling': False, 'replay_buffer_size': '1e5', 'gamma': 0.99, 'multi_step': 1, 'target_update_interval': 1000, 'eps_start': 1.0, 'eps_final': 0.001, 'eps_decay': 1000000}, 'num_process': 1, 'batch_size': 128, 'max_episodes': 50000, 'max_steps_per_episode': 10000, 'train_start_frame': 10000, 'save_id': 0, 'optimizer': 'adam', 'learning_rate': '1e-4', 'device': 'gpu', 'update_itr': 1, 'log_avg_window': 20, 'log_interval': 20, 'render': False, 'test': False, 'exploit': False, 'load_model_idx': False, 'load_model_full_path': False, 'multiprocess': False, 'eval_models': False, 'save_path': '', 'save_interval': 2000, 'wandb_activate': True, 'wandb_entity': 'quantumiracle', 'wandb_project': 'boxing-v5', 'wandb_group': '', 'wandb_name': '', 'net_architecture': {'hidden_dim_list': [512, 512], 'hidden_activation': 'ReLU', 'output_activation': False, 'channel_list': [32, 64, 64], 'kernel_size_list': [8, 4, 3], 'stride_list': [4, 2, 1]}, 'marl_method': False, 'marl_spec': {'min_update_interval': 20, 'score_avg_window': 10, 'global_state': False}}
Save models to : /data/zihan/research/MARS/data/model/0/gym_ALE/Boxing-v5_False. 
 Save logs to: /data/zihan/research/MARS/data/log/0/gym_ALE/Boxing-v5_False.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: \ 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: | 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: / 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: - 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: \ 0.013 MB of 0.013 MB uploaded (0.001 MB deduped)wandb: | 0.013 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: / 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: - 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: \ 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: | 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: / 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb: - 0.033 MB of 0.033 MB uploaded (0.001 MB deduped)wandb:                                                                                
wandb: W&B sync reduced upload amount by 2.9%             
wandb: Synced azure-serenity-1: https://wandb.ai/quantumiracle/boxing-v5/runs/2fpvngfm
wandb: Synced 7 W&B file(s), 0 media file(s), 0 artifact file(s) and 3 other file(s)
wandb: Find logs at: ./wandb/run-20221219_045044-2fpvngfm/logs
Traceback (most recent call last):
  File "test_single_agent_rl.py", line 32, in <module>
    rollout(env, model, args)
  File "/data/zihan/research/MARS/mars/rollout.py", line 23, in rollout
    rollout_normal(env, model, save_id, args)
  File "/data/zihan/research/MARS/mars/rollout.py", line 98, in rollout_normal
    obs = env.reset()
  File "/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/wrappers/record_video.py", line 109, in reset
    self.start_video_recorder()
  File "/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/wrappers/record_video.py", line 125, in start_video_recorder
    internal_backend_use=True,
  File "/data/zihan/anaconda3/envs/x/lib/python3.7/site-packages/gym/wrappers/monitoring/video_recorder.py", line 61, in __init__
    self.render_mode = env.render_mode
AttributeError: 'Gym2AgentWrapper' object has no attribute 'render_mode'
